# BizRobo! Timeline Manager 利用ガイド

このガイドは、「BizRobo! Timeline Manager」の基本的な使い方から便利な機能までを解説するユーザーマニュアルです。

### 1. はじめに

BizRobo! Timeline Manager は、BizRobo!のロボット（`.robot`）やタイプ（`.type`）ファイルの **「いつ」「誰が」「何を」変更したのかを記録・管理するためのツール** です。Git の難しいコマンドを覚える必要はなく、画面のボタンをクリックするだけで、安全にバージョン管理（タイムライン管理）を行えます。

#### **2 つの利用者層をサポート**

このツールは、主に 2 つの役割を持つ方々を対象としています。

1.  **BizRobo! 開発者 (シチズンデベロッパー)**

    - 「昔のバージョンのロボットに戻したい...」
    - 「他の人がどこを変更したのか知りたい...」
    - 「手動でのバックアップ管理が大変...」

    といったお悩みを解決し、日々のロボット開発をサポートします。

2.  **プロモーションマネージャー（Robot Lifecycle Management 推進者）**

    - 開発プロセスの管理やロボットの品質保証を行いたい。
    - GitHub のような外部サービスを使わず、社内のファイルサーバーで統制のとれた RLM（Robot Lifecycle Management）を実現したい。

    といった要望に応え、安全な開発基盤の構築を支援します。

このガイドでは、それぞれの役割に応じた使い方を解説していきます。

> [!Important]  
> Robot Lifecycle Management (RLM) は、ロボット開発のガバナンスを効かせ、品質、生産性、再利用性を向上させるための管理手法です。プロモーションマネージャーは、その推進役として開発標準の策定や本番環境へのリリース管理などを担います。
>
> 👉 [こちら](https://1010-junji.github.io/br-notes/RobotLifecycleManagement/) を参照ください。

### 2. 初回起動と共通セットアップ

アプリケーションを初めて起動すると、ウェルカム画面が表示されます。まず、利用を開始するためにいくつかの初期設定を行いましょう。

#### **Step 1: Git 環境のチェック**

本ツールは、内部で「Git」というバージョン管理システムを利用しています。そのため、コミット（変更の記録）を行う「あなた」が誰なのかを Git に教える必要があります。

1.  ウェルカム画面の `[初期設定]` カードにある **[Git のセットアップ確認]** ボタンをクリックします。
2.  ダイアログが表示され、チェック結果を確認できます。

    - **緑のチェックで「設定済み」と表示される場合:**

      ![スクリーンショット: Git設定が正常な場合のダイアログ。バージョン、ユーザー名、メールアドレスの全項目に緑のチェックアイコンが付いている様子。](images/git-conf-ok.png)

      準備は万端です！ すぐにツールの利用を開始できます。

    - **赤のエラーで「設定されていません」と表示される場合:**

      ![スクリーンショット: Git設定が不足している場合のダイアログ。ユーザー名とメールアドレスの項目に赤のクローズアイコンとエラーメッセージが表示されている様子。](images/git-conf-ng.png)

      ユーザー名やメールアドレスが未設定の状態です。このままでは誰が変更を記録したか分からなくなってしまうため、設定が必要です。
      PC の「コマンドプロンプト」または「ターミナル」を開き、ダイアログに表示されている以下のコマンドをコピー＆ペーストして実行してください。
      （`"あなたの名前"` と `your_email@example.com` はご自身のものに置き換えてください）

      ```bash
      git config --global user.name "あなたの名前"
      git config --global user.email "your_email@example.com"
      ```

      設定後、再度 **[Git のセットアップ確認]** ボタンを押し、すべての項目が緑のチェックに変わることを確認してください。

#### **Step 2: アプリケーションモードの選択**

本ツールには、利用目的別に 2 つの動作モードがあります。 `[動作設定]` カードのスライドトグルで切り替えられます。

- **開発者 (Developer) モード (デフォルト)**

  ![スクリーンショット: トグルが右側(ON)の「開発者」モード。トグルの右側に「開発者」と表示されている状態。](images/dev-mode.png)

  ご自身の PC でロボットを開発・編集する方向けのモードです。ロボットの編集、変更の記録、チームとの共有など、開発に必要な機能が揃っています。**ほとんどのユーザーはこちらのモードを使用します。**

- **RLM (Robot Lifecycle Management) モード**

  ![スクリーンショット: トグルが左側(OFF)の「RLM」モード。トグルの左側に「RLM」と表示されている状態。](images/rlm-mode.png)

  チーム開発の **原本（マスターデータ）** となる特別な保管庫（リポジトリ）を作成・管理する **プロモーションマネージャーや管理者向けのモード** です。リポジトリの初期セットアップに必要な機能も含まれます。

---

### 3. 【開発者向け】日々のロボット開発での使い方 (Developer Mode)

この章では、「開発者モード」を利用して、日々のロボット開発におけるバージョン管理を行う方法を解説します。
まずは一人で使う簡単な流れから始め、次にチームで共同作業する方法へとステップアップしていきましょう。

#### **A) まずは一人で使ってみる：個人のロボット開発**

自分の PC にあるロボットプロジェクトの変更履歴を記録していく、最も基本的な使い方です。

**Step 1: 保管庫（リポジトリ）の準備**

最初に一度だけ、ロボットファイルを保管するための「保管庫（リポジトリ）」を準備します。

1.  ウェルカム画面の `[タイムライン管理]` カードにある **[新規リポジトリ作成]** ボタンをクリックします。
2.  フォルダ選択ダイアログが表示されたら、管理したい BizRobo!プロジェクトのフォルダ（例: `C:\BizRobo\Projects\MyProject`）を選択します。
3.  これだけで準備は完了です。自動的にリポジトリが開かれ、メインの管理画面に切り替わります。

**Step 2: 日々の作業（編集 → 記録）**

ロボットを編集した後に、その変更を記録する一連の流れです。

![スクリーンショット: リポジトリを開いた後のメイン画面全体。左に変更ファイルリスト、右にコミット欄と履歴が表示されている。](images/repo-1st.png)

1.  **変更の検知**

    - Design Studio などでロボットファイル（`.robot`）やタイプファイル（`.type`）を編集・保存します。
    - すると、アプリが自動で変更を検知し、画面左側の `[変更されたファイル]` や `[新規に追加されたファイル]` リストに、該当するファイル名が表示されます。

2.  **ステージング (Staging)：記録する変更を選ぶ**

    - 今回はこの変更を記録に残したい、というファイルを選び出す作業です。
    - `[変更されたファイル]` リストにある、記録したいファイルの右側の **[+]** アイコン（ステージングする）をクリックします。
    - クリックされたファイルは、その上の `[ステージング済みのファイル]` エリアに移動します。これにより、「この変更を記録しますよ」という意思表示になります。

      ![スクリーンショット: ファイルをステージングして、[ステージング済みのファイル]エリアに移動した様子。UnstagedエリアからStagedエリアにファイルが移っている。](images/repo-stging.png)

3.  **コミット (Commit)：変更にメモを付けて記録する**

    - ステージングした変更内容に、後から見返しても分かるような「変更メモ」を付けて、保管庫に正式に記録します。この操作を「コミット」と呼びます。
    - 画面右側の `[コミット]` エリアにある **[コミットメッセージ]** の欄に、**何を変更したのか**が簡潔に分かるメモを入力します。（例: 「品番検索機能の不具合を修正」「新しいエラー処理を追加」など）
    - メッセージを入力したら、その下にある **[ステージング済みをコミット]** ボタンをクリックします。
    - コミットが成功すると、`[履歴]` リストの先頭に今記録した内容が追加され、`[変更]` エリアのファイルリストは空になります。

      ![スクリーンショット: コミットが完了し、履歴の先頭に新しいコミットが追加され、変更リストが空になった様子。](images/repo-commit.png)

これで、一つの変更作業の記録が完了しました。この「**編集 → ステージング → コミット**」のサイクルを繰り返すことで、ロボットのバージョンがタイムラインとして積み上がっていきます。

#### **B) チームで共同作業する：共有リポジトリでの開発**

チームで開発する場合、プロモーションマネージャーが用意した「共有リポジトリ」を使って、お互いの変更内容をやり取りします。

**Step 1: 共有リポジトリから自分の作業場を準備（Clone）**

チーム開発に参加する最初のステップです。共有リポジトリを自分の PC に複製（クローン）します。

1.  ウェルカム画面の `[初期設定]` カードにある **[共有リポジトリを複製]** ボタンをクリックします。
2.  ダイアログが表示されたら、管理者から共有された「共有リポジトリの URL」と、自分の PC で作業フォルダを置きたい「PC 上の保存先フォルダ」を指定します。
3.  **[複製 (Clone)]** ボタンを押すと、指定した保存先フォルダの中に、共有リポジトリと同じ名前のフォルダ（あなたの作業場）が作成され、自動的に開かれます。

**Step 2: 日々の作業サイクル**

チーム開発では、自分の作業と他の人の作業をスムーズに統合していくことが重要です。

1.  **変更を取り込む (Pull)**

    - 作業を始める前に、まずツールバー右上の **[↓]** (クラウドダウンロード) アイコンをクリックします。
    - これにより、共有リポジトリにある他のメンバーの最新の変更が、あなたの PC の作業場に反映されます。この操作を「プル」と呼びます。

2.  **自分の変更を編集・記録する (ステージング & コミット)**

    - ロボットを編集し、変更を加えます。
    - 変更が終わったら、前述の「A) まずは一人で使ってみる」の **Step 2** と同じ手順で、「**ステージング → コミット**」を行い、自分の変更をローカルの保管庫に記録します。

3.  **変更を共有する (Push)**
    - 自分の PC でコミットしただけでは、その変更はまだチームメンバーには見えません。
    - ツールバー右上の **[↑]** (クラウドアップロード) アイコンをクリックします。
    - これにより、あなたがコミットした変更が共有リポジトリへ送信され、チーム全体に共有されます。この操作を「プッシュ」と呼びます。

この「**Pull → 編集 → Commit → Push**」が、チーム開発での基本的なサイクルになります。

#### **便利な機能：開発をもっと快適に**

- **ブランチ：作業を安全に分岐させる**
  「メインの安定版ロボットはそのままに、新しい機能を並行して試したい」といった場合に「ブランチ（分岐）」が役立ちます。通常、ブランチはプロモーションマネージャーによって事前に準備されています。

  - **切替**: ツールバー中央のブランチ名が表示されている部分（例: `main`）をクリックするとメニューが開きます。ここで、自分が作業したいブランチに切り替えることができます。
  - **マージ（合流）**: 新機能用のブランチでの作業が完了したら、ブランチメニューの **[call_merge]** アイコンをクリックして、変更内容をメインのブランチに安全に合流させることができます。

- **過去の作業に戻す・確認する**

  - **変更の取り消し (Revert)**:

    - **機能:** `[履歴]` リストの各コミットの右側にある **[…]** メニューから **[この変更より後をすべて取り消す (Revert)]** を選択すると、そのコミット以降の**より新しい全ての変更**を取り消します。
    - **動作:** 例えば、履歴が「C ← B ← A」と積み上がっている状態でコミット「A」に対してこの操作を行うと、「C」と「B」と「A」の変更内容をすべて打ち消すための新しいコミットが自動で作成されます。これにより、履歴上はコミット「A」の前の状態に戻ります。
    - **注意点:** これは非常に強力な機能です。意図しない変更まで消してしまわないよう、どの時点に戻したいのかをよく確認してから実行してください。元の履歴が削除されることはなく、安全に元に戻すための操作です。

  - **タグ付け**: 「バージョン 1.0 完成」など、開発の節目となる重要なコミットの **[…]** メニューから **[タグを作成...]** を選択すると、その履歴に`v1.0`のような分かりやすい「目印（タグ）」を付けることができます。

---

### 4. 【プロモーションマネージャー向け】チーム開発の原本管理での使い方 (RLM Mode)

この章では、RLM の推進者であるプロモーションマネージャーの方が「RLM モード」を利用して、チームで開発するロボットファイルの **原本（マスターデータ）** を安全に一元管理する方法を解説します。

#### **RLM モードの目的**

GitHub のような外部のクラウドサービスを利用せずに、**社内のファイルサーバー上**に、チーム開発の中心となる「**共有リポジトリ（Bare Repository）**」を設置し、管理することがこのモードの主な目的です。

この共有リポジトリは、開発者たちが直接ファイルを編集する場所ではなく、変更履歴だけを格納する**金庫**のような役割を果たします。開発者たちはこの金庫からロボットの最新版を複製（Clone）してきて自分の PC で作業し、完成した変更内容を再び金庫に戻す（Push）という統制のとれた開発フローを実現します。

#### **Step 1: アプリケーションモードの切り替え**

まず、プロモーションマネージャーとして作業を行うために、アプリケーションを RLM モードに切り替えます。

1.  ウェルカム画面の `[動作設定]` カードを見つけます。
2.  `[アプリケーションモード]` のスライドトグルをクリックして **OFF** にし、左側の「RLM」が選択された状態にします。

![スクリーンショット: トグルが左側(OFF)の「RLM」モード。トグルの左側に「RLM」と表示されている状態。](images/rlm-mode.png)

RLM モードに切り替えると、プロモーションマネージャー向けの機能に絞られたシンプルなメニュー表示に変わります。

#### **Step 2: 共有リポジトリ（原本）の作成**

次に、チーム開発の核となる共有リポジトリを作成します。この作業は、リポジトリを設置したいファイルサーバー上のフォルダに対して行います。

1.  `[初期設定]` カードにある **[RLM 原本リポジトリの作成]** ボタンをクリックします。
2.  フォルダ選択ダイアログが表示されます。ここで、ファイルサーバー上の**空のフォルダ**を選択します。
    - 例: `\\fileserver\BizRobo\SharedRepo\ProjectA`
    - **注意:** このフォルダは、開発者全員が読み書きできる共有フォルダである必要があります。
3.  選択すると、指定したフォルダ内に共有リポジトリ（Bare Repository）が作成されます。完了メッセージが表示されれば成功です。

この操作により、指定されたフォルダは、変更履歴を格納するための特別な「金庫」としてセットアップされました。

#### **Step 3: 開発者への情報共有**

共有リポジトリを作成したら、開発者（BizRobo! Timeline Manager を開発者モードで使うユーザー）に、そのリポジトリの場所を伝える必要があります。

開発者には、以下の情報を共有してください。

- **共有リポジトリのパス（URL）**:
  - 先ほど作成した共有リポジトリのフォルダパスです。
  - 例: `\\fileserver\BizRobo\SharedRepo\ProjectA`

開発者は、このパスを使って「**3. B) チームで共同作業する**」の **Step 1** に記載されている **「共有リポジトリを複製（Clone）」** の操作を行うことで、チーム開発に参加できるようになります。

#### **補足: 初期ブランチの作成**

共有リポジトリを作成した直後や、開発のルールを整備する際に、プロモーションマネージャーが「ブランチ」を作成する必要があります。例えば、「開発用のブランチ」と「本番用のブランチ」を分けるといった運用が一般的です。

1.  RLM モードのまま、ウェルカム画面の **[既存リポジトリを開く]** をクリックし、開発者が Clone してきた作業用のリポジトリ（Bare Repository ではない）を開きます。
2.  ツールバー中央のブランチ名が表示されている部分をクリックすると、ブランチメニューが開きます。
3.  メニューの先頭にある **[新しいブランチを作成]** をクリックし、表示されたダイアログにブランチ名（例: `develop` や `production`）を入力して作成します。

作成したブランチは、開発者が `Pull` 操作を行うことで自分のローカル環境にも反映され、利用可能になります。

#### **プロモーションマネージャーの役割**

基本的に、共有リポジトリは一度作成すれば、後は自動的に開発者からの変更履歴（Push）を受け付け、蓄積していきます。プロモーションマネージャーが日常的に操作を行う必要はほとんどありません。

主な役割は以下の通りです。

- **初期セットアップ**: 上記の手順に沿って、プロジェクトごとに共有リポジトリや初期ブランチを作成します。
- **アクセス権の管理**: ファイルサーバーの機能を使って、共有リポジトリフォルダへのアクセス権を適切に管理します。
- **バックアップ**: 共有リポジトリのフォルダ全体を定期的にバックアップすることで、万が一の事態に備えます。
- **トラブルシューティング**: 高度な問題が発生した場合、後述の「CLI クライアント」機能を使ってリポジトリの状態を確認・修正することがあります。

---

### 5. 困ったときには (共通ガイド)

この章では、ツールの利用中に発生する可能性のある問題への対処法や、さらに便利な機能について解説します。

#### **コンフリクト（競合）への対処法**

チーム開発において、**「あなた」と「他の誰か」が、同じファイルの同じ箇所を別々に編集してしまった**場合に「コンフリクト（競合）」が発生します。これはエラーではなく、「どちらの変更を正とすべきか、人が判断する必要がある」というサインです。

コンフリクトは、他の人の変更を取り込む「Pull」や、ブランチを合流させる「Merge」の際に発生する可能性があります。

**Step 1: コンフリクトの発生を把握する**

![スクリーンショット: コンフリクト発生時の画面。上部に赤い警告バーが表示され、左側のファイルリストに[コンフリクト中のファイル]というセクションが現れている様子。](images/repo-conflict.png)

1.  コンフリクトが発生すると、画面上部に**赤い警告バー**が表示されます。
2.  対象となったファイルは、`[変更]` エリアの最上部にある `[コンフリクト中のファイル]` リストに表示されます。

**Step 2: コンフリクトを解決する**

`[コンフリクト中のファイル]` リストに表示された各ファイルについて、どの変更内容を採用するかを決定します。解決方法は主に 2 つあります。

- **A) ボタン一つで簡単解決（状況に応じた最適な選択）**

  コンフリクトの状況に応じて、最適な解決ボタンが表示されます。

  - **両者が同じファイルを編集した場合:**

    ![スクリーンショット: コンフリクト解決ボタン部分の拡大。「現在の変更を採用」「取り込む変更を採用」の2つのボタンが表示されている。](images/conflict-action.png)

    - **[現在の変更を採用] ボタン**: **あなたの**変更内容で、相手の変更を上書きします。
    - **[取り込む変更を採用] ボタン**: **相手の**変更内容で、あなたの変更を上書きします。

  - **一方が編集し、もう一方が削除した場合:**
    - **[ファイルの変更を維持] ボタン**: 相手の削除操作を無視し、あなたの変更内容でファイルを残します。
    - **[ファイルの削除を承認] ボタン**: あなたの変更を破棄し、ファイルを削除します。

  いずれかのボタンを押すと、ファイルは自動的に修正され、解決済み（ステージング済み）の状態になります。

- **B) 手動でじっくり解決（両方の変更内容をうまく組み合わせたい場合）**

  「相手の変更の良い部分と、自分の変更の良い部分を両方残したい」といった場合は、手動でファイルを編集して解決します。

  1.  まず **[中身を見る]** ボタンをクリックして、どのようにコンフリクトしているかを確認します。
      `<<<<<<< HEAD` から `=======` までがあなたの変更（現在の変更）、`=======` から `>>>>>>> ...` までが相手の変更（取り込む変更）です。
  2.  **【重要】** Design Studio ではコンフリクトマーカーが含まれたファイルを開くことができません。中身を見ても変更点の判断が難しい場合は、安全のため **[現在の変更を採用]** をクリックして一度自分の編集状態を正としてください。その後、必要に応じて相手のロボットファイルを手動で入手し、Design Studio で比較・マージすることをお勧めします。
  3.  （テキストエディタなどで）ファイル内に自動で挿入されている `<<<<<<<`, `=======`, `>>>>>>>` といったマーカー（目印）ごと不要な部分を削除し、両者の良いとこ取りをするなどして、ファイルを最終的にあるべき正しい状態に修正し、**上書き保存**します。
  4.  ファイルの修正が終わったら、Timeline Manager の画面に戻り、コンフリクトリストにあるファイルの右側の **[add_task]** アイコン（手動で修正完了したのでステージングする）をクリックします。これで「解決済み」として扱われます。

**Step 3: 解決の完了を記録する**

1.  `[コンフリクト中のファイル]` リストにある**すべてのファイル**に対して、Step 2 の解決作業を行います。
2.  すべてのファイルが解決され、`[ステージング済みのファイル]` エリアに移動したことを確認します。
3.  最後に、`[コミット]` エリアのボタンが **[マージを完了]**（または[変更の取り消しを完了]）に変わっているので、このボタンをクリックします。コミットメッセージは自動で入力されるため、変更は不要です。

これでコンフリクトの解決処理はすべて完了です。

#### **その他の便利な機能**

- **管理対象からファイルを除外する (.gitignore)**
  BizRobo!プロジェクトフォルダの中には、バックアップファイル（例: `MyRobot.robot.~`）など、バージョン管理する必要のないファイルが自動で生成されることがあります。これらを管理対象から恒久的に除外することができます。

  1.  ツールバー右上の **[⚙]** (歯車) アイコンをクリックし、メニューから **[除外ファイルの指定 (.gitignore)]** を選択します。
  2.  ダイアログが開くので、除外したいファイルやフォルダのパターンを一行ずつ入力します。
      - 例 1: `*.~` （末尾が `.~` で終わるすべてのファイルを除外）
      - 例 2: `temp/` （temp フォルダの中身をすべて除外）
  3.  **[保存]** をクリックすると設定が反映され、以降は指定したファイルが変更リストに表示されなくなります。

- **管理者向け CLI クライアント**
  （主にプロモーションマネージャーや上級者向け）GUI にない高度な Git 操作が必要な場合、コマンドを直接実行できる画面を利用できます。

  - ツールバーの **[⚙]** メニューから **[CLI クライアント (管理者向け)]** を選択すると、専用のダイアログが開きます。

- **ログの確認**
  アプリケーションの動作に問題があった場合、原因調査の手がかりとして操作ログが記録されています。
  - ウェルカム画面の `[動作設定]` カードにある **[ログ設定]** ボタンをクリックします。
  - 開いたダイアログで **[ログフォルダを開く]** ボタンを押すと、ログファイルが保存されているフォルダを直接開くことができます。
